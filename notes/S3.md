# S3 (Simple Storage Service)

- Muitos sites usam com backbone.
- Muitos serviços da AWS usam o S3.
- Buckets precisam ter nomes globalmente únicos.
- Buckets são definidos a nível de Region.
- Regras de nomenclatura para buckets:
  - Não é permitido letra maiúscula.
  - Não é permitido underscore (`_`).
  - Tamanho de 3 a 63 caracteres.
  - Deve começar com letra minuscula ou número.
- Objetos (arquivos) tem Key que são os caminhos completos dos arquivos. Exemplo:
  - `meu_bucket/meu_arquivo.txt`. Onde o bucket é o `meu_bucket` e a key é `/meu_arquivo.txt`.
  - `meu_bucket/minha_pasta/minha_subpasta/meu_arquivo.txt`. Onde o bucket é o `meu_bucket` e a key é `/minha_pasta/minha_subpasta/meu_arquivo.txt`.
- Não existe o conceito de pasta dentro do bucket.
- Características dos objetos:
  - Tamanho máximo de 5TB.
  - Upload de arquivos maiores que 5GB devem utilizar o **_multi part upload_**.
- Metadata (text key/value pair - system ou user metadata).
- Tags (Unicode key/value pair - máximo de 10) e importante para segurança.
- Version ID.

## S3 - Versionamento

- É possível habilitar version para arquivos no S3.
- É habilitado no nível Bucket.
- Versões são identificadas por IDs gerados pela AWS.
- Vantagens de utilizar versionamento:
  - Proteger contra deleção acidental.
  - Fácil de restaurar versões anteriores.
- Se o versionamento não estiver habilitado a versão dos arquivos será **null**.

## S3 - Criptografia

- É importante saber qual método utilizar para cada situação.
- Existem 4 métodos diferentes para criptografar um objeto no S3:
  - SSE-S3: Criptografia de objetos usando key gerenciada pela AWs:
    - Criptografia ocorre no lado do servidor.
    - Criptografia do tipo AES-256.
    - Header deve ser: **_"x-amz-server-side-encryption": "AES256"_**.
  - SSE-KMS: Key gerenciada pela Key Manager Service:
    - Criptografia ocorre no lado do servidor.
    - Vantagens de usar KMS: controlado pelo usuário e há rastreamento para auditoria.
    - Header deve ser: **_"x-amz-server-side-encryption": "aws:kms"_**.
  - SSE-C: Usuário gerencia a própria key:
    - S3 não armazena a Encryption Key fornecida pelo cliente.
    - É obrigatório o uso de HTTPS.
    - Encryption Key deve estar presente no header HTTPS para todas as requisições.
  - Client side encryption: Criptografia no lado do cliente:
    - Cliente gerencia a key e o ciclo de vida da criptografia.
    - Cliente deve criptografar o arquivo para enviar para o S3 e descriptografar quando buscar arquivos do S3.
    - A criptografia pode ser feita com bibliotecas como por exemplo a **_Amazon S3 Encryption Client_**.
